"use strict";let series=[],seriesFavs=[],seriesList=document.querySelector(".js-series-list");const seriesFavourites=document.querySelector(".js-favs"),input=document.querySelector(".js-input"),btn=document.querySelector(".js-btn"),resetBtn=document.querySelector(".js-btn-delete"),deleteIcon=document.querySelector(".js-icon");function handleGetInfoSeries(){getApi()}function paintSeries(){let e="",t="";for(const s of series){t=isFav(s)?"color-fav":"";const i=s.show.name;let n=s.show.image,o="https://via.placeholder.com/210x295/ffffff/666666/?text=TV";n=null===n?o:s.show.image.medium,e+=`<li class="list--li js-serieBox ${t}" id="${s.show.id}">`,e+=`<img src="${n}" width="315" height="315" class="serie-img"/>`,e+=`<h3 class="serie-title">${i}</h3>`,e+="</li>"}seriesList.innerHTML=e,listenSerie()}function preventBtn(e){e.preventDefault()}function handleClickEv(e){const t=parseInt(e.currentTarget.id),s=series.find(e=>e.show.id===t),i=seriesFavs.findIndex(e=>e.show.id===t);-1===i?seriesFavs.push(s):seriesFavs.splice(i,1),paintFavs(),paintSeries(),setLocalStorage()}function listenSerie(){const e=document.querySelectorAll(".js-serieBox");for(const t of e)t.addEventListener("click",handleClickEv)}function paintFavs(){let e='<li class="title-fav">Series favoritas: </li>';for(const t of seriesFavs){let s=t.show.name,i=t.show.id,n=t.show.image,o="https://via.placeholder.com/210x295/ffffff/666666/?text=TV";n=null===n?o:t.show.image.medium,e+=`<li class="li--fav js-serieBox" id="${i}">`,e+=`<img src="${n}" width="200" height="200" class="img-fav" />`,e+=`<h3 class="serie-title">${s}</h3>`,e+='<button class="js-delete-btn delete-btn">X</button>',e+="</li>"}seriesFavourites.innerHTML=e}function isFav(e){return void 0!==seriesFavs.find(t=>t.show.id===e.show.id)}function deleteFavSerie(){const e=document.querySelectorAll(".js-delete-btn");for(const t of e)t.addEventListener("click",deleteFavorite)}function deleteFavorite(e){const t=parseInt(e.currentTarget.id),s=seriesFavs.findIndex(e=>e.show.id===t);-1!==s&&seriesFavs.splice(s,1),setLocalStorage()}function deleteAllFavs(){deleteFromWeb(),localStorage.clear()}function deleteFromWeb(){seriesFavourites.remove()}function setLocalStorage(){const e=JSON.stringify(seriesFavs);localStorage.setItem("seriesFavs",e)}function getApi(){const e=input.value;fetch("http://api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{series=e,paintSeries(),setLocalStorage()})}function getLocalStorage(){const e=localStorage.getItem("seriesFavs");if(null===e)getApi();else{const t=JSON.parse(e);seriesFavs=t,paintFavs(),deleteFavSerie()}}function handleClickResetBtn(){location.reload()}btn.addEventListener("click",handleGetInfoSeries),btn.addEventListener("click",preventBtn),deleteIcon.addEventListener("click",deleteAllFavs),getLocalStorage(),resetBtn.addEventListener("click",handleClickResetBtn);